<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Cards</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            background: #f5f5f5;
        }

        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            width: 95%;
            max-width: 300px;
            padding: 10px;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .top-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 10px;
        }

        .uniCode {
            text-align: center;
            color: coral;
            font-size: small;
            font-weight: bold;



        }

        .logo {
            width: 50px;

            display: none;
        }

        .buttons {}

        .buttons button {
            font-size: large;
            height: 25px;
            width: 25px;
            border: none;
            background: rgba(255, 0, 0, 0.13);
            color: rgb(174, 0, 0);
            border-radius: 50%;
            cursor: pointer;
        }

        .rotate {
            transform: rotate(90deg);
        }



        .middle-section {
            flex-grow: 1;
            text-align: center;
        }

        .question {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: 600;
            line-height: 1.5;
        }

        .image-container img {
            max-width: 80%;
            max-height: 100px;
        }

        .bottom-section {
            display: flex;
            flex-direction: row;
            padding: 10px;
        }

        .bottom-section-col {
            display: flex;
            flex-direction: column;
            padding: 10px;
        }

        .left-options,
        .right-options {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
            margin: 2px;
        }

        .option {
            padding: 8px;
            background: #eee;
            border-radius: 5px;
            cursor: pointer;
        }

        .bold {
            font-weight: bolder;
        }
    </style>
</head>

<body>
    <script>
        const uniCodeData = '✮⋆˙ Wings Junior : GK Class 5 ✬';
        const cardsData = [
            {
                id: 'Que 1: ',
                question: 'What is the capital of France?',
                options: ['Berlin Berlin Berlin Berlin Berlin Berlin Berlin Berlin', 'Madrid', 'Paris', 'Rome'],
                image: 'logo.png',
                optionBig: 'y'
            }
        ];

        function createCard(cardData) {
            const card = document.createElement('div');
            card.classList.add('card');
            card.id = cardData.id;

            const topSection = document.createElement('div');
            topSection.classList.add('top-section');

            const logo = document.createElement('img');
            logo.src = 'logo.png';
            logo.classList.add('logo');
            topSection.appendChild(logo);

            const uniCode = document.createElement('div');
            uniCode.innerText = `${uniCodeData}`;
            uniCode.classList.add('uniCode');
            topSection.appendChild(uniCode);

            const buttons = document.createElement('div');
            buttons.classList.add('buttons');
            buttons.innerHTML = `
                <button class ="rotate" onclick="downloadCard('${cardData.id}')">⇨</button>
                <button onclick="shareCard('${cardData.id}')">⇨</button>
            `;
            topSection.appendChild(buttons);
            card.appendChild(topSection);

            const middleSection = document.createElement('div');
            middleSection.classList.add('middle-section');

            const question = document.createElement('div');
            question.classList.add('question');
            question.innerHTML = `<p><span class="bold"> ${card.id}</span> ${cardData.question} </p> `;
            middleSection.appendChild(question);

            if (cardData.image) {
                const imageContainer = document.createElement('div');
                imageContainer.classList.add('image-container');
                const img = document.createElement('img');
                img.src = cardData.image;
                imageContainer.appendChild(img);
                middleSection.appendChild(imageContainer);
            }
            card.appendChild(middleSection);

            const bottomSection = document.createElement('div');
            bottomSection.classList.add('bottom-section');


            if (cardData.optionBig) {
                bottomSection.classList.add('bottom-section-col');
            }



            const leftOptions = document.createElement('div');
            leftOptions.classList.add('left-options');
            leftOptions.innerHTML = `<div class="option">A. ${cardData.options[0]}</div>
                                    <div class="option">B. ${cardData.options[1]}</div>`;

            const rightOptions = document.createElement('div');
            rightOptions.classList.add('right-options');
            rightOptions.innerHTML = `<div class="option">C. ${cardData.options[2]}</div>
                                     <div class="option">D. ${cardData.options[3]}</div>`;

            bottomSection.appendChild(leftOptions);
            bottomSection.appendChild(rightOptions);
            card.appendChild(bottomSection);

            document.body.appendChild(card);
        }

        function downloadCard(cardId) {
    const card = document.getElementById(cardId);
    const buttons = card.querySelector('.buttons');
    buttons.style.display = 'none'; // Hide buttons before capture

    html2canvas(card).then(canvas => {
        let imgData = canvas.toDataURL("image/png"); // ✅ Correct format

        let link = document.createElement("a");
        link.href = imgData;
        link.download = "card.png"; // ✅ Set filename for download
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link); // ✅ Clean up
        buttons.style.display = 'block'; // Show buttons again
    });
}


        function shareCard(cardId) {
            downloadCard(cardId, function (imgData) {
                let blob = dataURLToBlob(imgData);
                let file = new File([blob], 'card.png', { type: 'image/png' });
                let dataTransfer = new DataTransfer();
                dataTransfer.items.add(file);

                let shareData = {
                    files: [file],
                    title: "Quiz Card"
                };

                if (navigator.canShare && navigator.canShare(shareData)) {
                    navigator.share(shareData).catch(err => console.error("Error sharing image: ", err));
                } else {
                    alert("Sharing not supported, please download and share manually.");
                }
            });
        }

        function dataURLToBlob(dataURL) {
            let arr = dataURL.split(','), mime = arr[0].match(/:(.*?);/)[1],
                bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
            while (n--) {
                u8arr[n] = bstr.charCodeAt(n);
            }
            return new Blob([u8arr], { type: mime });
        }

        cardsData.forEach(createCard);
    </script>
</body>

</html>