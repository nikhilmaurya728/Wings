<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Location</title>
</head>
<body>
    <h1>Updating Location...</h1>

    <!-- ✅ Firebase SDK V8 -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // ✅ Firebase Configuration (अपनी सही API Key और Details भरो)
        var firebaseConfig = {
            apiKey: "तुम्हारी_API_KEY",
            authDomain: "milk-man-24d97.firebaseapp.com",
            databaseURL: "https://milk-man-24d97-default-rtdb.europe-west1.firebasedatabase.app/",
            projectId: "milk-man-24d97",
            storageBucket: "milk-man-24d97.appspot.com",
            messagingSenderId: "103608166782",
            appId: "तुम्हारा_APP_ID"
        };

        // ✅ Firebase Initialize
        firebase.initializeApp(firebaseConfig);
        var database = firebase.database();

        function updateLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.watchPosition((position) => {
                    var lat = position.coords.latitude;
                    var lon = position.coords.longitude;
                    
                    console.log(`Updating Location: ${lat}, ${lon}`); // Debugging

                    // ✅ Firebase Database में लोकेशन अपडेट करो
                    database.ref("milkman/location").set({
                        lat: lat,
                        lon: lon,
                        timestamp: new Date().toISOString()
                    }).then(() => {
                        document.body.innerHTML = `<h1>Location Updated: ${lat}, ${lon}</h1>`;
                    }).catch((error) => {
                        console.error("Error updating location:", error);
                        document.body.innerHTML = `<h1>Error: ${error.message}</h1>`;
                    });

                }, (error) => {
                    console.error("Error getting location:", error);
                    document.body.innerHTML = `<h1>Location Error: ${error.message}</h1>`;
                }, {
                    enableHighAccuracy: true, // GPS से सटीक लोकेशन लो
                    maximumAge: 5000, // 5 सेकंड के भीतर पुरानी लोकेशन स्वीकार करें
                    timeout: 10000 // 10 सेकंड के बाद टाइमआउट
                });
            } else {
                document.body.innerHTML = "<h1>Geolocation is not supported by this browser.</h1>";
            }
        }

        // ✅ Function Call
        updateLocation();
    </script>
</body>
</html>
